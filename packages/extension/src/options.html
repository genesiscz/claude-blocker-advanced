<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Claude Blocker Advanced Settings</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <div class="noise"></div>

    <div class="container">
      <!-- Header -->
      <header>
        <div class="brand">
          <div class="logo-mark">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="11" width="18" height="11" rx="2" fill="#FFD700" stroke="#B8860B" stroke-width="0.5"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="#666" stroke-width="1.5" fill="none"/>
            </svg>
          </div>
          <div class="brand-text">
            <h1>Claude Blocker Advanced</h1>
            <span class="version">v0.1.0</span>
          </div>
        </div>

        <div class="status-badge" id="status-badge">
          <span class="status-indicator" id="status-indicator"></span>
          <span id="status-text">Connecting...</span>
        </div>
      </header>

      <!-- Tab Navigation -->
      <nav class="tab-nav">
        <button class="tab-btn active" data-tab="sessions">
          Sessions
          <span class="tab-badge" id="sessions-badge">0</span>
        </button>
        <button class="tab-btn" data-tab="history">
          History
          <span class="tab-badge" id="history-badge">0</span>
        </button>
        <button class="tab-btn" data-tab="stats">Stats</button>
        <button class="tab-btn" data-tab="settings">Settings</button>
        <button class="tab-btn" data-tab="about">About</button>
      </nav>

      <!-- Main Content -->
      <main>
        <!-- Sessions Tab -->
        <div class="tab-content active" id="tab-sessions">
          <!-- Stats Cards -->
          <section class="stats-section">
            <div class="stat-card">
              <span class="stat-value" id="sessions">0</span>
              <span class="stat-label">Sessions</span>
            </div>
            <div class="stat-card">
              <span class="stat-value" id="working">0</span>
              <span class="stat-label">Working</span>
            </div>
            <div class="stat-card" id="blocking-card">
              <span class="stat-value" id="block-status">-</span>
              <span class="stat-label">Status</span>
            </div>
          </section>

          <!-- Active Sessions Section -->
          <section class="sessions-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Active Sessions</h2>
                <p class="section-desc">Claude Code instances currently running</p>
              </div>
              <div class="filter-dropdown">
                <select id="session-sort">
                  <option value="status">Sort by Status</option>
                  <option value="project">Sort by Project</option>
                  <option value="activity">Sort by Activity</option>
                  <option value="uptime">Sort by Uptime</option>
                </select>
              </div>
            </div>
            <div class="sessions-list" id="sessions-list">
              <div class="no-sessions">No active sessions</div>
            </div>
          </section>

          <!-- Activity Timeline Section -->
          <section class="timeline-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Activity Timeline</h2>
                <p class="section-desc">Session activity over the last 4 hours</p>
              </div>
              <div class="timeline-legend">
                <span class="legend-item"><span class="legend-dot working"></span>Working</span>
                <span class="legend-item"><span class="legend-dot waiting"></span>Waiting</span>
                <span class="legend-item"><span class="legend-dot idle"></span>Idle</span>
              </div>
            </div>
            <div class="timeline-container" id="timeline-container">
              <div class="timeline-time-axis" id="timeline-time-axis"></div>
              <div class="timeline-tracks" id="timeline-tracks">
                <div class="no-timeline">No activity to display</div>
              </div>
            </div>
          </section>
        </div>

        <!-- History Tab -->
        <div class="tab-content" id="tab-history">
          <section class="history-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Session History</h2>
                <p class="section-desc">Past sessions from the last 7 days</p>
              </div>
              <div class="filter-dropdown">
                <select id="history-filter">
                  <option value="all">All Time</option>
                  <option value="today">Today</option>
                  <option value="yesterday">Yesterday</option>
                  <option value="week">This Week</option>
                </select>
              </div>
            </div>
            <div class="history-list" id="history-list">
              <div class="no-history">No session history yet</div>
            </div>
          </section>
        </div>

        <!-- Stats Tab -->
        <div class="tab-content" id="tab-stats">
          <!-- Today's Overview -->
          <section class="stats-overview-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Today's Productivity</h2>
                <p class="section-desc" id="stats-date">Loading...</p>
              </div>
            </div>

            <div class="stats-hero">
              <div class="stats-ring-container">
                <svg class="stats-ring" viewBox="0 0 120 120">
                  <circle class="stats-ring-bg" cx="60" cy="60" r="52" />
                  <circle class="stats-ring-idle" cx="60" cy="60" r="52" id="ring-idle" />
                  <circle class="stats-ring-waiting" cx="60" cy="60" r="52" id="ring-waiting" />
                  <circle class="stats-ring-working" cx="60" cy="60" r="52" id="ring-working" />
                </svg>
                <div class="stats-ring-center">
                  <span class="stats-ring-value" id="stats-total-time">0h 0m</span>
                  <span class="stats-ring-label">Total</span>
                </div>
              </div>

              <div class="stats-breakdown">
                <div class="stats-breakdown-item working">
                  <div class="stats-breakdown-dot"></div>
                  <div class="stats-breakdown-info">
                    <span class="stats-breakdown-label">Working</span>
                    <span class="stats-breakdown-value" id="stats-working-time">0h 0m</span>
                  </div>
                  <span class="stats-breakdown-pct" id="stats-working-pct">0%</span>
                </div>
                <div class="stats-breakdown-item waiting">
                  <div class="stats-breakdown-dot"></div>
                  <div class="stats-breakdown-info">
                    <span class="stats-breakdown-label">Waiting</span>
                    <span class="stats-breakdown-value" id="stats-waiting-time">0h 0m</span>
                  </div>
                  <span class="stats-breakdown-pct" id="stats-waiting-pct">0%</span>
                </div>
                <div class="stats-breakdown-item idle">
                  <div class="stats-breakdown-dot"></div>
                  <div class="stats-breakdown-info">
                    <span class="stats-breakdown-label">Idle</span>
                    <span class="stats-breakdown-value" id="stats-idle-time">0h 0m</span>
                  </div>
                  <span class="stats-breakdown-pct" id="stats-idle-pct">0%</span>
                </div>
              </div>
            </div>

            <div class="stats-counts">
              <div class="stats-count-card">
                <span class="stats-count-value" id="stats-sessions-started">0</span>
                <span class="stats-count-label">Sessions Started</span>
              </div>
              <div class="stats-count-card">
                <span class="stats-count-value" id="stats-sessions-ended">0</span>
                <span class="stats-count-label">Sessions Ended</span>
              </div>
            </div>

            <div class="stats-usage-cards">
              <div class="stats-usage-card">
                <span class="stats-usage-label">Tokens Used</span>
                <span class="stats-usage-value" id="stats-tokens">0</span>
                <span class="stats-usage-breakdown">
                  <span id="stats-input-tokens">0</span> in Â· <span id="stats-output-tokens">0</span> out
                </span>
              </div>
              <div class="stats-usage-card">
                <span class="stats-usage-label">Total Cost</span>
                <span class="stats-usage-value" id="stats-cost">$0.00</span>
              </div>
            </div>
          </section>

          <!-- Weekly Chart -->
          <section class="stats-weekly-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Last 7 Days</h2>
                <p class="section-desc">Daily Claude usage patterns</p>
              </div>
            </div>

            <div class="stats-chart-container">
              <div class="stats-chart" id="stats-weekly-chart">
                <!-- Bars will be rendered by JS -->
              </div>
              <div class="stats-chart-labels" id="stats-chart-labels">
                <!-- Labels will be rendered by JS -->
              </div>
            </div>

            <div class="stats-chart-legend">
              <span class="stats-legend-item"><span class="stats-legend-dot working"></span>Working</span>
              <span class="stats-legend-item"><span class="stats-legend-dot waiting"></span>Waiting</span>
              <span class="stats-legend-item"><span class="stats-legend-dot idle"></span>Idle</span>
            </div>
          </section>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="tab-settings">
          <!-- Overlay Settings Section -->
          <section class="overlay-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Status Overlay</h2>
                <p class="section-desc">Show session status on all pages</p>
              </div>
            </div>

            <div class="settings-group">
              <label class="toggle-row">
                <span class="toggle-label">Enable overlay</span>
                <input type="checkbox" id="overlay-enabled" checked />
                <span class="toggle-switch"></span>
              </label>

              <div class="setting-row">
                <label for="overlay-scope">Show on</label>
                <select id="overlay-scope">
                  <option value="all">All pages</option>
                  <option value="blocked">Blocked sites only</option>
                  <option value="none">Disabled</option>
                </select>
              </div>

              <div class="setting-row">
                <label for="overlay-position">Position</label>
                <select id="overlay-position">
                  <option value="top-right">Top Right</option>
                  <option value="top-left">Top Left</option>
                  <option value="bottom-right">Bottom Right</option>
                  <option value="bottom-left">Bottom Left</option>
                </select>
              </div>

              <div class="setting-row">
                <label for="overlay-opacity">Opacity</label>
                <input type="range" id="overlay-opacity" min="0.3" max="1" step="0.1" value="0.9" />
                <span class="opacity-value" id="opacity-value">90%</span>
              </div>
            </div>

          </section>

          <!-- Notifications Section -->
          <section class="notifications-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Notifications</h2>
                <p class="section-desc">Get notified about session events</p>
              </div>
            </div>

            <div class="settings-group">
              <label class="toggle-row">
                <span class="toggle-label">Enable notifications</span>
                <input type="checkbox" id="notifications-enabled" checked />
                <span class="toggle-switch"></span>
              </label>

              <label class="toggle-row sub-toggle">
                <span class="toggle-label">Notify when waiting for input</span>
                <input type="checkbox" id="notify-waiting" checked />
                <span class="toggle-switch"></span>
              </label>

              <label class="toggle-row sub-toggle">
                <span class="toggle-label">Notify when session finished</span>
                <input type="checkbox" id="notify-finished" checked />
                <span class="toggle-switch"></span>
              </label>

              <label class="toggle-row sub-toggle">
                <span class="toggle-label">Notify when session disconnected</span>
                <input type="checkbox" id="notify-disconnected" checked />
                <span class="toggle-switch"></span>
              </label>

              <div class="notification-test-row">
                <button type="button" class="test-notification-btn" id="test-notification-btn">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
                    <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                  </svg>
                  Test Notification
                </button>
                <span class="notification-status" id="notification-status">Not tested</span>
              </div>

              <div class="notification-debug" id="notification-debug">
                <span class="debug-label">Debug Info</span>
                <pre id="notification-debug-info">Loading...</pre>
              </div>
            </div>
          </section>

          <!-- Sound Settings Section -->
          <section class="sound-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Sound Alerts</h2>
                <p class="section-desc">Play audio when notifications are triggered</p>
              </div>
            </div>

            <div class="settings-group">
              <label class="toggle-row">
                <span class="toggle-label">Enable sound alerts</span>
                <input type="checkbox" id="sound-enabled" checked />
                <span class="toggle-switch"></span>
              </label>

              <div class="setting-row">
                <label for="sound-volume">Volume</label>
                <input type="range" id="sound-volume" min="0" max="100" step="5" value="70" />
                <span class="volume-value" id="volume-value">70%</span>
              </div>

              <div class="sound-per-event">
                <div class="setting-row">
                  <label for="sound-waiting">Waiting for input</label>
                  <select id="sound-waiting">
                    <option value="none">None</option>
                    <option value="subtle" selected>Subtle chime</option>
                    <option value="clear">Attention bell</option>
                    <option value="say">Voice (say)</option>
                  </select>
                </div>

                <div class="setting-row">
                  <label for="sound-finished">Finished working</label>
                  <select id="sound-finished">
                    <option value="none">None</option>
                    <option value="subtle" selected>Subtle chime</option>
                    <option value="clear">Attention bell</option>
                    <option value="say">Voice (say)</option>
                  </select>
                </div>

                <div class="setting-row">
                  <label for="sound-disconnected">Session disconnected</label>
                  <select id="sound-disconnected">
                    <option value="none">None</option>
                    <option value="subtle" selected>Subtle chime</option>
                    <option value="clear">Attention bell</option>
                    <option value="say">Voice (say)</option>
                  </select>
                </div>
              </div>

              <div class="sound-test-row">
                <button type="button" class="test-sound-btn" id="test-sound-subtle">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                    <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
                    <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                  </svg>
                  Subtle
                </button>
                <button type="button" class="test-sound-btn" id="test-sound-clear">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                    <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
                    <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                  </svg>
                  Clear
                </button>
                <button type="button" class="test-sound-btn" id="test-sound-say">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                    <line x1="12" y1="19" x2="12" y2="23"/>
                    <line x1="8" y1="23" x2="16" y2="23"/>
                  </svg>
                  Voice
                </button>
              </div>
            </div>
          </section>

          <!-- Terminal Settings Section -->
          <section class="terminal-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Terminal</h2>
                <p class="section-desc">Select your preferred terminal for session actions</p>
              </div>
            </div>

            <div class="settings-group">
              <div class="setting-row">
                <label for="terminal-app">Terminal Application</label>
                <select id="terminal-app">
                  <option value="warp">Warp</option>
                  <option value="iterm2">iTerm2</option>
                  <option value="terminal">Terminal.app</option>
                  <option value="ghostty">Ghostty</option>
                </select>
              </div>
            </div>
          </section>

          <!-- Editor Settings Section -->
          <section class="editor-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Editor</h2>
                <p class="section-desc">Select your preferred code editor for opening projects</p>
              </div>
            </div>

            <div class="settings-group">
              <div class="setting-row">
                <label for="editor-app">Editor Application</label>
                <select id="editor-app">
                  <option value="cursor">Cursor</option>
                  <option value="vscode">VS Code</option>
                  <option value="windsurf">Windsurf</option>
                  <option value="zed">Zed</option>
                  <option value="sublime">Sublime Text</option>
                  <option value="webstorm">WebStorm</option>
                </select>
              </div>
            </div>
          </section>

          <!-- Blocked Sites Section -->
          <section class="sites-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Blocked Sites</h2>
                <p class="section-desc">These sites will be blocked when Claude Code is idle</p>
              </div>
              <span class="site-count" id="site-count">0</span>
            </div>

            <!-- Add Domain Form -->
            <form class="add-form" id="add-form">
              <div class="input-wrapper">
                <input
                  type="text"
                  id="domain-input"
                  placeholder="example.com"
                  spellcheck="false"
                  autocomplete="off"
                />
                <kbd class="input-hint">Enter</kbd>
              </div>
              <button type="submit" class="add-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"/>
                  <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
                <span>Add Site</span>
              </button>
            </form>

            <!-- Domain List -->
            <ul class="domain-list" id="domain-list">
              <!-- Populated by JS -->
            </ul>
          </section>

          <!-- Bypass Section -->
          <section class="bypass-section">
            <div class="section-header">
              <div class="section-title">
                <h2>Emergency Bypass</h2>
                <p class="section-desc">Get 5 minutes of unblocked access (once per day)</p>
              </div>
            </div>

            <button class="bypass-btn" id="bypass-btn" disabled>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12,6 12,12 16,14"/>
              </svg>
              <span id="bypass-text">Activate Bypass</span>
            </button>
            <p class="bypass-status" id="bypass-status">Loading...</p>
          </section>
        </div>

        <!-- About Tab -->
        <div class="tab-content" id="tab-about">
          <section class="about-section">
            <div class="about-header">
              <div class="about-logo">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                  <rect x="3" y="11" width="18" height="11" rx="2" fill="#FFD700" stroke="#B8860B" stroke-width="0.5"/>
                  <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="#666" stroke-width="1.5" fill="none"/>
                </svg>
              </div>
              <div class="about-title">
                <h2>Claude Blocker Advanced</h2>
                <span class="about-version">Version 0.1.0</span>
              </div>
            </div>

            <p class="about-desc">
              A productivity tool that blocks distracting websites when Claude Code is idle,
              helping you stay focused while waiting for AI-assisted tasks to complete.
            </p>

            <div class="about-features">
              <h3>Features</h3>
              <ul>
                <li>Real-time session monitoring</li>
                <li>Automatic site blocking when idle</li>
                <li>Status overlay on all pages</li>
                <li>Desktop notifications for session events</li>
                <li>Emergency bypass for urgent access</li>
              </ul>
            </div>

            <div class="about-links">
              <h3>Links</h3>
              <div class="link-grid">
                <a href="https://github.com/genesiscz/claude-blocker" target="_blank" class="about-link">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                  </svg>
                  GitHub Repository
                </a>
                <a href="https://github.com/genesiscz/claude-blocker/issues" target="_blank" class="about-link">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4"/>
                    <path d="M12 8h.01"/>
                  </svg>
                  Report Issue
                </a>
                <a href="https://github.com/genesiscz/claude-blocker/blob/main/PRIVACY.md" target="_blank" class="about-link">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                  </svg>
                  Privacy Policy
                </a>
                <a href="https://github.com/genesiscz/claude-blocker/blob/main/LICENSE" target="_blank" class="about-link">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                    <polyline points="10 9 9 9 8 9"/>
                  </svg>
                  MIT License
                </a>
              </div>
            </div>

            <div class="about-credits">
              <p>Made with focus in mind. Block distractions when Claude is idle.</p>
            </div>
          </section>
        </div>
      </main>

      <!-- Footer -->
      <footer>
        <p>Made for focus. Block distractions when Claude is idle.</p>
      </footer>
    </div>

    <!-- Live overlay preview (fixed position on screen) -->
    <div class="live-preview" id="overlay-preview">
      <span class="preview-dot"></span>
      <span class="preview-text">1 working</span>
      <span class="preview-badge">Preview</span>
    </div>

    <!-- Toast container -->
    <div class="toast-container" id="toast-container"></div>

    <script src="options.global.js"></script>
  </body>
</html>
